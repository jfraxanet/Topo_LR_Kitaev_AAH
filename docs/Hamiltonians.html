---

title: HAMILTONIANS

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_Hamiltonians.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to obtain the Hamiltonian in the momentum space, we start from the follwing Hamiltonian:</p>
\begin{equation}\label{eq: hamiltonian}
    H = \sum_{n=0}^{N-1} \left [t \left (c^\dagger_{i+1}c_{i} + c^\dagger_{i}c_{i+1}\right) - \mu f(i)\left ( 2c^\dagger_{i}c_{i}-1\right) + \sum_{l=1}^{N-1}\frac{\Delta}{d^\alpha_l}\left (c^\dagger_{i+l}c^\dagger_{i} + c_{i}c_{i+l}\right)\right],
\end{equation}<p>where $t$ is the hopping amplitude, $\mu$ is the chemical potential, $\Delta$ is the superconducting pairing amplitude and $c_{i}(c^\dagger_{i})$ are the annihilation (creation) operators at the $i$-th site of the chain. The superconducting pairing is taken to decay as a power law $l^{-\alpha}$, where $l$ denotes the distance between the sites and the scaling exponent $\alpha \in \mathbb{R}$. For a constant chemical potential $f(i)=1$, we recover the long-range Kitaev chain with homogeneous onsite potential. The AAH chemical potential corresponds to $f(i) = \cos\left (2 \pi n \frac{F_{n-1}}{F_{n}} + \phi \right )$, where $F_{n-1},F_n$ are integers from the Fibonacci sequence and $\phi$ is the phase. Therefore, our Hamiltonian has a periodicity of $F_n = q$ sites.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.1-REAL-SPACE-HAMILTONIAN-WITH-OBC">1.1 REAL SPACE HAMILTONIAN WITH OBC<a class="anchor-link" href="#1.1-REAL-SPACE-HAMILTONIAN-WITH-OBC"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's consider the following basis $\chi = \left(c_{0}, c^\dagger_{0}, c_{1}, c^\dagger_{1}, ..., c_{N-1}, c^\dagger_{N-1}\right)^T$. The Hamiltonian can be expressed as follows:</p>
\begin{equation}
    H = \chi^\dagger H_N \chi
\end{equation}<p>where:
\begin{equation}
H_N = 
\begin{pmatrix}
A_0 &amp; B &amp; C_2 &amp; C_3 &amp; \cdots &amp; C_{N-2} &amp; -B^\dagger\\
B^\dagger &amp; A_1 &amp; B &amp; C_2 &amp; \cdots &amp; C_{N-3} &amp; C_{N-2}\\
C_2^\dagger &amp; B^\dagger &amp; A_2 &amp; B &amp; \cdots &amp; C_{N-2} &amp; C_{N-3}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{N-2}^\dagger &amp; C_{N-3}^\dagger &amp; C_{N-4}^\dagger &amp; C_{N-5}^\dagger &amp; \cdots &amp; A_{N-2} &amp; B\\
-B &amp; C_{N-2}^\dagger &amp; C_{N-3}^\dagger &amp; C_{N-4}^\dagger &amp; \cdots &amp; B^\dagger &amp; A_{N-1},
\end{pmatrix}
\end{equation}</p>
<p>where</p>
\begin{equation}
A_{j} = 
\begin{pmatrix}
-\mu f(j) &amp; 0 \\
0 &amp; +\mu f(j)
\end{pmatrix},
\end{equation}\begin{equation}
B = \begin{pmatrix}
t/2 &amp; -\Delta \\
+\Delta  &amp; -t/2
\end{pmatrix},
\end{equation}\begin{equation}
C_l = \begin{pmatrix}
0 &amp; -\Delta/d_l^\alpha \\
+\Delta/d_l^\alpha  &amp; 0
\end{pmatrix}.
\end{equation}<p>and $d_l = \text{Min}(l, N-l)$. In order to obtain these results, we have considered anti-periodic boundary conditions. This means that our Hamiltonian has the following form:
\begin{equation}
H = \sum_{i=0}^{N-2} \frac{t}{2} \left (c_i^\dagger c_{i+1} - c_{i+1} c_i^\dagger + c_{i+1}^\dagger c_i - c_{i} c_{i+1}^\dagger\right) -\frac{t}{2}\left(c_{N-1}^\dagger c_0 - c_0 c_{N-1}^\dagger + c_0^\dagger c_{N-1} - c_{N-1} c_0^\dagger\right) + \sum_{i=0}^{N-1} \mu f(i)\left (c^\dagger_{i}c_{i}-c_{i}c^\dagger_{i}\right) +\sum_{i=0}^{N-1}\sum_{l=1}^{N-1-i} \frac{\Delta}{d^\alpha_l}\left (c_{i+1}^\dagger c_i^\dagger - c_i^\dagger c_{i+l}^\dagger + c_i c_{i+l} - c_{i+l} c_{i}\right).
\end{equation}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_OBC_Kitaev_LR_QP" class="doc_header"><code>H_OBC_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_OBC_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with OBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_OBC_Majoranas_Kitaev_LR_QP" class="doc_header"><code>H_OBC_Majoranas_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_OBC_Majoranas_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with OBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length. Here we use the Majorana basis.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.2-REAL-SPACE-HAMILTONIAN-WITH-APBC">1.2 REAL SPACE HAMILTONIAN WITH APBC<a class="anchor-link" href="#1.2-REAL-SPACE-HAMILTONIAN-WITH-APBC"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the system has a periodicity of $q$ sites, we can split it into supercells. Let's consider that we have $L = N/q$ of such supercells, and let's consider the spinor $\chi_u = \left(c_{qu}, c^\dagger_{qu}, c_{qu+1}, c^\dagger_{qu+1}, ..., c_{qu+(q-1)}, c^\dagger_{qu+(q-1)}\right)^T$. The Hamiltonian can be expressed as follows:</p>
\begin{equation}
    H = \sum_{u=0}^{L-1} \left[ \chi_u^\dagger H_{\text{local}} \chi_u + ( \chi_u^\dagger H_{\text{hop}} \chi_{u+1} + {\rm h.c.})
    + \sum_{l=1}^{L-1}( \chi_u^\dagger H_{\text{l}} \chi_{u+l} + {\rm h.c.}) \right],
\end{equation}<p>where,</p>
\begin{equation}
H_{\text{local}} = 
\begin{pmatrix}
A_0 &amp; B &amp; C_2 &amp; \cdots &amp; C_{q-1}\\
B^\dagger &amp; A_1 &amp; B &amp; \cdots  &amp; C_{q-2}\\
C_2^\dagger &amp; B^\dagger &amp; A_2  &amp; \cdots  &amp; C_{q-3}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{q-2}^\dagger &amp; C_{q-3}^\dagger &amp; C_{q-4}^\dagger  &amp; \cdots  &amp; B\\
C_{q-1}^\dagger &amp; C_{q-2}^\dagger &amp; C_{q-3}^\dagger &amp; \cdots &amp; A_{q-1}
\end{pmatrix},
\end{equation}\begin{equation}
H_{\text{hop}} = 
\begin{pmatrix}
0 &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; 0 &amp;  \cdots  &amp; 0\\
\vdots   &amp; \vdots &amp; \ddots &amp; \vdots\\
B' &amp; 0 &amp;  \cdots  &amp; 0
\end{pmatrix},
\end{equation}<p>and,</p>
\begin{equation}
H_{\text{l}} = 
\begin{pmatrix}
C_{l,0,0} &amp; C_{l,0,1} &amp; \cdots &amp; C_{l,0,q-1}\\
C_{l,1,0} &amp; C_{l,1,1} &amp; \cdots &amp; C_{l,1,q-1}\\
C_{l,2,0} &amp; C_{l,2,1} &amp; \cdots  &amp; C_{l,2,q-1}\\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{l,q-2,0} &amp; C_{l,q-2,1} &amp; \cdots &amp;  C_{l,q-2,q-1}\\
C_{l,q-1,0} &amp; C_{l,q-1,1} &amp; \cdots &amp; C_{l,q-1,q-1}
\end{pmatrix},
\end{equation}<p>where $B' = \frac{t}{2}\sigma_z$ and $C_{l,x,y} = -\frac{\Delta}{2d_{l,x,y}^{\alpha}} i\sigma_y$. For the system with APBC,</p>
\begin{equation}
d_{l,x,y} = \text{min}\left(lq-(x-y), N-(lq-(x-y))\right).
\end{equation}<p>To obtain these results, we have imposed anti-periodic boundary conditions. This means that, for the local Hamiltonian we assume that $c_{uq+x+q} = -c_{uq+x}$. Then:</p>
\begin{equation}
\sum_{u=0}^{L-1} \chi_u^\dagger H_{local} \chi_u = \sum_{u=0}^{L-1} \left[\sum_{x = 0}^{q-2} \frac{t}{2} \left (c_{uq+x}^\dagger c_{uq+x+1} - c_{uq+x+1} c_{uq+x}^\dagger + c_{uq+x+1}^\dagger c_{uq+x} - c_{uq+x} c_{uq+x+1}^\dagger\right) - \sum_{x=0}^{q-1} \mu f(uq+x)\left (c^\dagger_{uq+x}c_{uq+x}-c_{uq+x}c^\dagger_{uq+x}\right) + \sum_{x=0}^{q-1}\sum_{l=1}^{q-1-x} \frac{\Delta}{l^\alpha}\left (c_{uq+x+l}^\dagger c_{uq+x}^\dagger - c_{uq+x}^\dagger c_{uq+x+l}^\dagger + c_{uq+x} c_{uq+x+l} - c_{uq+x+l} c_{uq+x}\right)\right]
\end{equation}<p>For the Hamiltonians connecting different supercells, we have to use that $c_{(u+L)q + x} = -c_{uq+x}$. Then, we obtain:</p>
\begin{equation}
\sum_{u=0}^{L-1} \left[ \chi_u^\dagger H_{hop} \chi_{u+1} + h.c. \right]= \sum_{u=0}^{L-2} \left[\frac{t}{2} \left (c_{uq+(q-1)}^\dagger c_{(u+1)q} - c_{(u+1)q} c_{uq+(q-1)}^\dagger + c_{(u+1)q}^\dagger c_{uq+(q-1)} - c_{uq+(q-1)} c_{(u+1)q}^\dagger\right)\right] +  \frac{t}{2} \left (c_{N-1}^\dagger c_{0} - c_{0} c_{N-1}^\dagger + c_{0}^\dagger c_{N-1} - c_{N-1} c_{0}^\dagger\right)
\end{equation}\begin{equation}
\sum_{u=1}^{L-1} \sum_{l=1}^{L-1}\left[\chi_u^\dagger H_{l} \chi_{u+l} + h.c.\right] = \sum_{u=0}^{L-1} \sum_{l=1}^{L-1-u} \left[\sum_{x = 0}^{q-1}\sum_{x = 0}^{q-1} \frac{\Delta}{d_{l,x,y}^\alpha} \left (c_{(u+1)q+x}^\dagger c_{uq+y}^\dagger - c_{uq+y}^\dagger c_{(u+l)q+y}^\dagger + c_{uq+y} c_{(u+l)q+x} - c_{(u+l)q+x} c_{uq+y}\right)\right]
\end{equation}<p>which can also be expressed as:</p>
\begin{equation}
\sum_{u=0}^{L-1} \left[\frac{t}{2} \left (c_{uq+(q-1)}^\dagger c_{(u+1)q} - c_{(u+1)q} c_{uq+(q-1)}^\dagger + c_{(u+1)q}^\dagger c_{uq+(q-1)} - c_{uq+(q-1)} c_{(u+1)q}^\dagger\right)\right]
\end{equation}\begin{equation}
\sum_{u=0}^{L-1} \sum_{l=1}^{L-1} \left[\sum_{x = 0}^{q-1}\sum_{x = 0}^{q-1} \frac{\Delta}{2 d_{l,x,y}^\alpha} \left (c_{(u+1)q+x}^\dagger c_{uq+y}^\dagger - c_{uq+y}^\dagger c_{(u+l)q+y}^\dagger + c_{uq+y} c_{(u+l)q+x} - c_{(u+l)q+x} c_{uq+y}\right)\right]
\end{equation}<p>if we explicitly impose that $c_{(u+L)q + x} = -c_{uq+x}$. We will see in the next section how this is done.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_APBC_Kitaev_LR_QP" class="doc_header"><code>H_APBC_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L115" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_APBC_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with APBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.3-MOMENTUM-SPACE-HAMILTONIAN-FOR-FINITE-LENGTH">1.3 MOMENTUM SPACE HAMILTONIAN FOR FINITE LENGTH<a class="anchor-link" href="#1.3-MOMENTUM-SPACE-HAMILTONIAN-FOR-FINITE-LENGTH"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we want to write the Hamiltonian in momentum space. We transform the spinor $\chi_u$ as follows:</p>
\begin{eqnarray}
    \chi_u = \frac{1}{\sqrt{L}} \sum_{k} e^{iku} \chi_k,
    \chi_u^\dagger = \frac{1}{\sqrt{L}} \sum_{k} e^{-iku} \chi_k^\dagger,
\end{eqnarray}<p>where $\chi_k= \left(c_{k,0}, c^\dagger_{-k,0}, c_{k, 1}, c^\dagger_{-k, 1}, ..., c_{k, q-1}, c^\dagger_{-k, q-1})\right)^T$. We need to find out which values of $k$ we are considering. Because of the anti-periodic boundary conditions, we want the following to hold:
\begin{equation}
    \chi_{u+L} = -\chi_{u},
\end{equation}
therefore:
\begin{equation}
    \frac{1}{\sqrt{L}} \sum_{k} e^{ik(u+L)} \chi_k = -\frac{1}{\sqrt{L}} \sum_{k} e^{iku} \chi_k,
\end{equation}
meaning that $kL = (2m + 1)\pi$ where $m$ takes values from $\{0,1,2,...L-1\}$.</p>
<p>Now, if we do the Fourier transform of the Hamiltonian we obtain:</p>
\begin{equation}
    H = \sum_{k} \biggl[ \chi_k^\dagger H_\text{local} \chi_k + (e^{ik} \chi_k^\dagger H_\text{hop} \chi_k + {\rm h.c.}\right) + \sum_{l=1}^{L-1}\left(e^{ikl}\chi_k^\dagger H_{l} \chi_{k} + {\rm h.c.}\right)\biggl],
\end{equation}<p>where we have used:
\begin{equation}
\sum_{u=0}^{L-1} e^{i(k-k')u} = L\delta_{kk'}.
\end{equation}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_Kitaev_LR_QP" class="doc_header"><code>H_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>True</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the momentum Hamiltonian with APBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.4-MOMENTUM-SPACE-HAMILTONIAN-FOR-INFINITE-SYSTEM">1.4 MOMENTUM SPACE HAMILTONIAN FOR INFINITE SYSTEM<a class="anchor-link" href="#1.4-MOMENTUM-SPACE-HAMILTONIAN-FOR-INFINITE-SYSTEM"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the infinite system, $L$ goes to infinity. Then, we need to change $d_l = l$ and $d_{l,x,y} = lq-(x-y))$ because we are not using the anti-periodic boundary conditions. 
Then, the Hamiltonian in momentum space looks as follows:</p>
\begin{equation}
    H = \sum_{k} \biggl[\chi_k^\dagger H_\text{local} \chi_k + \left(e^{ik}\chi_k^\dagger H_\text{hop} \chi_k + \text{h.c.}\right)  + \left(\chi_k^\dagger H_\text{inf} \chi_{k} + \text{h.c.}\right)\biggl]
\end{equation}<p>where:</p>
\begin{equation}
H_{l, inf} = 
\begin{pmatrix}
C_{0,0} &amp; C_{0,1} &amp; C_{0,2} &amp; C_{0,3} &amp; \cdots &amp; C_{0,q-2} &amp; C_{0,q-1}\\
C_{1,0} &amp; C_{1,1} &amp; C_{1,2} &amp; C_{1,3} &amp; \cdots &amp; C_{1,q-2} &amp; C_{1,q-1}\\
C_{2,0} &amp; C_{2,1} &amp; C_{2,2} &amp; C_{2,3} &amp; \cdots &amp; C_{2,q-2} &amp; C_{2,q-1}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{q-2,0} &amp; C_{q-2,1} &amp; C_{q-2,2} &amp; C_{q-2,3} &amp; \cdots &amp; C_{q-2,q-2} &amp; C_{q-2,q-1}\\
C_{q-1,0} &amp; C_{q-1,1} &amp; C_{q-1,2} &amp; C_{q-1,3} &amp; \cdots &amp; C_{q-1,q-2} &amp; C_{q-1,q-1}
\end{pmatrix},
\end{equation}<p>where $C_{x,y} = ig_{xy}\sigma_y$. The function $g_{xy}$ is defined as follows</p>
\begin{eqnarray}
g_{xy} = -\sum_{l=1}^{\infty} \frac{\Delta e^{ikl}}{[q-(x-y)]^\alpha}  = \frac{e^{ik}}{q^{\alpha}} \text{HLP}_{\alpha} \left(k, q, x-y\right),
\end{eqnarray}<p>where HLP is the Hurwitz Lerth Phi function, also called the Lerch trascendent function.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_Kitaev_LR_QP_inf" class="doc_header"><code>H_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L254" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Compute the momentum Hamiltonian with APBC for the Kitaev chain
with any value of alpha and Fn1/Fn. The system is infinite.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_k_H_Kitaev_LR_QP_inf" class="doc_header"><code>d_k_H_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L320" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_k_H_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Analytical derivative of the Hamiltonian for k in momentum space for an infinite system.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_phase_H_Kitaev_LR_QP_inf" class="doc_header"><code>d_phase_H_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L357" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_phase_H_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Analytical derivative of the Hamiltonian for phi in momentum space for an infinite system.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---FINITE-SYSTEM">1.5 UPPER-RIGHT BLOCK OF THE CHIRAL HAMILTONIAN - FINITE SYSTEM<a class="anchor-link" href="#1.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---FINITE-SYSTEM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="h_chiral_Kitaev_LR_QP" class="doc_header"><code>h_chiral_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L395" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>h_chiral_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Computes one block of the off-diagonal Hamiltonian in momentum space for a finite system with APBC</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---INFINITE-SYSTEM">1.5 UPPER-RIGHT BLOCK OF THE CHIRAL HAMILTONIAN - INFINITE SYSTEM<a class="anchor-link" href="#1.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---INFINITE-SYSTEM"> </a></h2><p>** I separated HLP_d and the infinite analytical expressions for the Hamiltonian in order to make the code more efficient</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="h_chiral_Kitaev_LR_QP_inf" class="doc_header"><code>h_chiral_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L443" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>h_chiral_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>AA</code></strong>, <strong><code>H_pbc_delta</code></strong>)</p>
</blockquote>
<p>Computes one block of the off-diagonal Hamiltonian in momentum space for an infinite system</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_pbc_sp" class="doc_header"><code>H_pbc_sp</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L479" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_pbc_sp</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>)</p>
</blockquote>
<p>Computes the analytical expression of the long-range infinite part of
the off-diagonal Hamiltonian. Does not depend on the chemical potential.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_h_chiral_Kitaev_LR_QP_inf" class="doc_header"><code>d_h_chiral_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L498" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_h_chiral_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>AA</code></strong>, <strong><code>d_H_pbc_delta</code></strong>)</p>
</blockquote>
<p>Computes the analytical derivative of k of one block of the off-diagonal Hamiltonian
in momentum space for an infinite system</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_H_pbc_sp" class="doc_header"><code>d_H_pbc_sp</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L516" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_H_pbc_sp</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>)</p>
</blockquote>
<p>Computes the analytical derivative of the long-range infinite part of
the off-diagonal Hamiltonian. Does not depend on the chemical potential.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HLP_d" class="doc_header"><code>HLP_d</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L535" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HLP_d</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>, <strong><code>Fn</code></strong>, <strong><code>dist</code></strong>)</p>
</blockquote>
<p>Closed form of sum of exponents using HLP function. dist is y-x</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="OTHER-FUNCTIONS">OTHER FUNCTIONS<a class="anchor-link" href="#OTHER-FUNCTIONS"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Fibonacci" class="doc_header"><code>Fibonacci</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L544" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Fibonacci</code>(<strong><code>iterations</code></strong>)</p>
</blockquote>
<p>Return Fibonacci sequence number depending on the iterations</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rot_sigma_y" class="doc_header"><code>rot_sigma_y</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L558" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rot_sigma_y</code>(<strong><code>pvec</code></strong>, <strong><code>psi</code></strong>, <strong><code>Fn</code></strong>)</p>
</blockquote>
<p>Rotation around sigma y of an angle psi</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="f" class="doc_header"><code>f</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L569" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>f</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>)</p>
</blockquote>
<p>Function f(k,alpha) in terms of the polylog functions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df" class="doc_header"><code>df</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L577" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>)</p>
</blockquote>
<p>Derivative of function f(k,alpha) in terms of the polylog functions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HLP" class="doc_header"><code>HLP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L585" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HLP</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>, <strong><code>Fn</code></strong>, <strong><code>x</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>
<p>Closed form of sum of exponens using HLP function</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

