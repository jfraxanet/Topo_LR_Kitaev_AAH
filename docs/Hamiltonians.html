---

title: HAMILTONIANS

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_Hamiltonians.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1.-LONG-RANGE-AND-QUASI-PERIODIC-KITAEV-CHAIN---HAMILTONIANS">1. LONG RANGE AND QUASI-PERIODIC KITAEV CHAIN - HAMILTONIANS<a class="anchor-link" href="#1.-LONG-RANGE-AND-QUASI-PERIODIC-KITAEV-CHAIN---HAMILTONIANS"> </a></h1><p>In order to obtain the Hamiltonian in the momentum space, we start from the follwing Hamiltonian:</p>
\begin{equation}\label{eq: hamiltonian}
    H = \sum_{n=0}^{N-1} \left [t \left (c^\dagger_{n+1}c_{n} + c^\dagger_{n}c_{n+1}\right) - \mu f(n)\left ( 2c^\dagger_{n}c_{n}-1\right) + \sum_{l=1}^{N-1}\frac{\Delta}{d^\alpha_l}\left (c^\dagger_{n+l}c^\dagger_{n} + c_{n}c_{n+l}\right)\right],
\end{equation}<p>where $t$ is the hopping amplitude, $\mu$ is the chemical potential, $\Delta$ is the superconducting pairing amplitude and $c_{n}(c^\dagger_{n})$ are the annihilation (creation) operators at the $n$th site of the chain. Consider we have a $N$ sites in the chain and the function $f(n) = 1-\cos\left (2 \pi n \frac{F_{n-1}}{F_{n}} + \phi \right )$, where $F_{n-1},F_n$ are integer from the Fibonacci sequence and $\phi$ is the phase. Therefore, our Hamiltonian has a periodicity of $F_n = q$ sites.</p>
<h2 id="CALCULATIONS">CALCULATIONS<a class="anchor-link" href="#CALCULATIONS"> </a></h2><h3 id="REAL-SPACE-HAMILTONIAN-WITH-APBC">REAL SPACE HAMILTONIAN WITH APBC<a class="anchor-link" href="#REAL-SPACE-HAMILTONIAN-WITH-APBC"> </a></h3><p>Let's consider the following basis $\chi = \left(c_{0}, c^\dagger_{0}, c_{1}, c^\dagger_{1}, ..., c_{N-1}, c^\dagger_{N-1}\right)^T$. The Hamiltonian can be expressed as follows:</p>
\begin{equation}
    H = \chi^\dagger H_N \chi
\end{equation}<p>where:
\begin{equation}
H_N = 
\begin{pmatrix}
A_0 &amp; B &amp; C_2 &amp; C_3 &amp; \cdots &amp; C_{N-2} &amp; -B^\dagger\\
B^\dagger &amp; A_1 &amp; B &amp; C_2 &amp; \cdots &amp; C_{N-3} &amp; C_{N-2}\\
C_2^\dagger &amp; B^\dagger &amp; A_2 &amp; B &amp; \cdots &amp; C_{N-2} &amp; C_{N-3}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{N-2}^\dagger &amp; C_{N-3}^\dagger &amp; C_{N-4}^\dagger &amp; C_{N-5}^\dagger &amp; \cdots &amp; A_{N-2} &amp; B\\
-B &amp; C_{N-2}^\dagger &amp; C_{N-3}^\dagger &amp; C_{N-4}^\dagger &amp; \cdots &amp; B^\dagger &amp; A_{N-1},
\end{pmatrix}
\end{equation}</p>
<p>where</p>
\begin{equation}
A_{j} = 
\begin{pmatrix}
-\mu f(j) &amp; 0 \\
0 &amp; +\mu f(j)
\end{pmatrix},
\end{equation}\begin{equation}
B = \begin{pmatrix}
t/2 &amp; -\Delta \\
+\Delta  &amp; -t/2
\end{pmatrix},
\end{equation}\begin{equation}
C_l = \begin{pmatrix}
0 &amp; -\Delta/d_l^\alpha \\
+\Delta/d_l^\alpha  &amp; 0
\end{pmatrix}.
\end{equation}<p>and $d_l = Min(l, N-l)$. In order to obtain these results, we have considered anti-periodic boundary conditions. This means that our Hamiltonian has the following form:
\begin{equation}
H = \sum_{n=0}^{N-2} \frac{t}{2} \left (c_n^\dagger c_{n+1} - c_{n+1} c_n^\dagger + c_{n+1}^\dagger c_n - c_{n} c_{n+1}^\dagger\right) -\frac{t}{2}\left(c_{N-1}^\dagger c_0 - c_0 c_{N-1}^\dagger + c_0^\dagger c_{N-1} - c_{N-1} c_0^\dagger\right) + \sum_{n=0}^{N-1} \mu f(n)\left (c^\dagger_{n}c_{n}-c_{n}c^\dagger_{n}\right) +\sum_{n=0}^{N-1}\sum_{l=1}^{N-1-n} \frac{\Delta}{d^\alpha_l}\left (c_{n+1}^\dagger c_n^\dagger - c_n^\dagger c_{n+l}^\dagger + c_n c_{n+l} - c_{n+l} c_{n}\right).
\end{equation}</p>
<h3 id="REAL-SPACE-HAMILTONIAN---SUPERCELLS">REAL SPACE HAMILTONIAN - SUPERCELLS<a class="anchor-link" href="#REAL-SPACE-HAMILTONIAN---SUPERCELLS"> </a></h3><p>Now, let's try to express the same Hamiltonian using a different basis. Since the system has a periodicity of $q$ sites, we can split it into supercells. Let's consider that we have $L = N/q$ of such supercells, and let's consider the spinor $\chi_u^q = \left(c_{qu}, c^\dagger_{qu}, c_{qu+1}, c^\dagger_{qu+1}, ..., c_{qu+(q-1)}, c^\dagger_{qu+(q-1)}\right)^T$. The Hamiltonian can be expressed as follows:</p>
\begin{equation}
    H = \sum_{u=0}^{L-1} \left[ (\chi_u^q)^\dagger H_{local} (\chi_u^q) + \left[(\chi_u^q)^\dagger H_{hop} (\chi_{u+1}^q) + h.c.\right] + \sum_{l=1}^{L-1}\left[(\chi_u^q)^\dagger H_{l} (\chi_{u+l}^q) + h.c.\right]\right].
\end{equation}<p>Again, we will need to impose anti-periodic boundary conditions and we obtain:</p>
\begin{equation}
H_{local} = 
\begin{pmatrix}
A_0 &amp; B &amp; C_2 &amp; C_3 &amp; \cdots &amp; C_{q-2} &amp; C_{q-1}\\
B^\dagger &amp; A_1 &amp; B &amp; C_2 &amp; \cdots &amp; C_{q-3} &amp; C_{q-2}\\
C_2^\dagger &amp; B^\dagger &amp; A_2 &amp; B &amp; \cdots &amp; C_{q-2} &amp; C_{q-3}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{q-2}^\dagger &amp; C_{q-3}^\dagger &amp; C_{q-4}^\dagger &amp; C_{q-5}^\dagger &amp; \cdots &amp; A_{q-2} &amp; B\\
C_{q-1}^\dagger &amp; C_{q-2}^\dagger &amp; C_{q-3}^\dagger &amp; C_{q-4}^\dagger &amp; \cdots &amp; B^\dagger &amp; A_{q-1}
\end{pmatrix},
\end{equation}<p>where</p>
\begin{equation}
A_{j} = 
\begin{pmatrix}
-\mu f(j) &amp; 0 \\
0 &amp; +\mu f(j)
\end{pmatrix},
\end{equation}\begin{equation}
B = \begin{pmatrix}
t/2 &amp; -\Delta \\
+\Delta  &amp; -t/2
\end{pmatrix},
\end{equation}\begin{equation}
C_l = \begin{pmatrix}
0 &amp; -\Delta/d_l^\alpha \\
+\Delta/d_l^\alpha  &amp; 0
\end{pmatrix}.
\end{equation}<p>and $d_l = Min(l, N-l)$. The other Hamiltonians are:</p>
\begin{equation}
H_{PBC} = 
\begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp;  \cdots &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0\\
B &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0
\end{pmatrix},
\end{equation}<p>where:</p>
\begin{equation}
B = \begin{pmatrix}
t/2 &amp; 0 \\
0  &amp; -t/2.
\end{pmatrix}
\end{equation}<p>and:</p>
\begin{equation}
H_{l} = 
\begin{pmatrix}
C_{l,0,0} &amp; C_{l,0,1} &amp; C_{l,0,2} &amp; C_{l,0,3} &amp; \cdots &amp; C_{l,0,q-2} &amp; C_{l,0,q-1}\\
C_{l,1,0} &amp; C_{l,1,1} &amp; C_{l,1,2} &amp; C_{l,1,3} &amp; \cdots &amp; C_{l,1,q-2} &amp; C_{l,1,q-1}\\
C_{l,2,0} &amp; C_{l,2,1} &amp; C_{l,2,2} &amp; C_{l,2,3} &amp; \cdots &amp; C_{l,2,q-2} &amp; C_{l,2,q-1}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{l,q-2,0} &amp; C_{l,q-2,1} &amp; C_{l,q-2,2} &amp; C_{l,q-2,3} &amp; \cdots &amp; C_{l,q-2,q-2} &amp; C_{l,q-2,q-1}\\
C_{l,q-1,0} &amp; C_{l,q-1,1} &amp; C_{l,q-1,2} &amp; C_{l,q-1,3} &amp; \cdots &amp; C_{l,q-1,q-2} &amp; C_{l,q-1,q-1}
\end{pmatrix},
\end{equation}<p>where:</p>
\begin{equation}
C_{l,x,y} = \frac{\Delta}{2 d_{l,x,y}^\alpha}
\begin{pmatrix}
0 &amp; -1 \\
1  &amp; 0
\end{pmatrix}.
\end{equation}<p>and $d_{l,x,y} = Min(lq-(x-y), N-(lq-(x-y)))$.</p>
<p>To obtain these results, we have imposed anti-periodic boundary conditions. This means that, for the local Hamiltonian we assume that $c_{uq+x+q} = -c_{uq+x}$. Then:</p>
\begin{equation}
\sum_{u=0}^{L-1} (\chi_u^q)^\dagger H_{local} (\chi_u^q) = \sum_{u=0}^{L-1} \left[\sum_{x = 0}^{q-2} \frac{t}{2} \left (c_{uq+x}^\dagger c_{uq+x+1} - c_{uq+x+1} c_{uq+x}^\dagger + c_{uq+x+1}^\dagger c_{uq+x} - c_{uq+x} c_{uq+x+1}^\dagger\right) - \sum_{x=0}^{q-1} \mu f(uq+x)\left (c^\dagger_{uq+x}c_{uq+x}-c_{uq+x}c^\dagger_{uq+x}\right) + \sum_{x=0}^{q-1}\sum_{l=1}^{q-1-x} \frac{\Delta}{l^\alpha}\left (c_{uq+x+l}^\dagger c_{uq+x}^\dagger - c_{uq+x}^\dagger c_{uq+x+l}^\dagger + c_{uq+x} c_{uq+x+l} - c_{uq+x+l} c_{uq+x}\right)\right]
\end{equation}<p>For the Hamiltonians connecting different supercells, we have to use that $c_{(u+L)q + x} = -c_{uq+x}$. Then, we obtain:</p>
\begin{equation}
\sum_{u=0}^{L-1} \left[ (\chi_u^q)^\dagger H_{hop} (\chi_{u+1}^q) + h.c. \right]= \sum_{u=0}^{L-2} \left[\frac{t}{2} \left (c_{uq+(q-1)}^\dagger c_{(u+1)q} - c_{(u+1)q} c_{uq+(q-1)}^\dagger + c_{(u+1)q}^\dagger c_{uq+(q-1)} - c_{uq+(q-1)} c_{(u+1)q}^\dagger\right)\right] +  \frac{t}{2} \left (c_{N-1}^\dagger c_{0} - c_{0} c_{N-1}^\dagger + c_{0}^\dagger c_{N-1} - c_{N-1} c_{0}^\dagger\right)
\end{equation}\begin{equation}
\sum_{u=1}^{L-1} \sum_{l=1}^{L-1}\left[(\chi_u^q)^\dagger H_{l} (\chi_{u+l}^q) + h.c.\right] = \sum_{u=0}^{L-1} \sum_{l=1}^{L-1-u} \left[\sum_{x = 0}^{q-1}\sum_{x = 0}^{q-1} \frac{\Delta}{d_{l,x,y}^\alpha} \left (c_{(u+1)q+x}^\dagger c_{uq+y}^\dagger - c_{uq+y}^\dagger c_{(u+l)q+y}^\dagger + c_{uq+y} c_{(u+l)q+x} - c_{(u+l)q+x} c_{uq+y}\right)\right]
\end{equation}<p>which can also be expressed as:</p>
\begin{equation}
\sum_{u=0}^{L-1} \left[\frac{t}{2} \left (c_{uq+(q-1)}^\dagger c_{(u+1)q} - c_{(u+1)q} c_{uq+(q-1)}^\dagger + c_{(u+1)q}^\dagger c_{uq+(q-1)} - c_{uq+(q-1)} c_{(u+1)q}^\dagger\right)\right]
\end{equation}\begin{equation}
\sum_{u=0}^{L-1} \sum_{l=1}^{L-1} \left[\sum_{x = 0}^{q-1}\sum_{x = 0}^{q-1} \frac{\Delta}{2 d_{l,x,y}^\alpha} \left (c_{(u+1)q+x}^\dagger c_{uq+y}^\dagger - c_{uq+y}^\dagger c_{(u+l)q+y}^\dagger + c_{uq+y} c_{(u+l)q+x} - c_{(u+l)q+x} c_{uq+y}\right)\right]
\end{equation}<p>if we explicitly impose that $c_{(u+L)q + x} = -c_{uq+x}$. We will see in the next section how this is done.</p>
<h3 id="FOURIER-TRANSFORM">FOURIER TRANSFORM<a class="anchor-link" href="#FOURIER-TRANSFORM"> </a></h3><p>Now, we want to write the Hamiltonian in momentum space. We transform the spinor $\chi_n^q$ as follows:
\begin{eqnarray}\label{eq:fourier}
    \chi_u^q = \frac{1}{\sqrt{L}} \sum_{k} e^{iku} \chi_k^q,
    (\chi_u^q)^\dagger = \frac{1}{\sqrt{L}} \sum_{k} e^{-iku} (\chi_k^q)^\dagger,
\end{eqnarray}
where $\chi_k^q= \left(c_{k,0}, c^\dagger_{-k,0}, c_{k, 1}, c^\dagger_{-k, 1}, ..., c_{k, q-1}, c^\dagger_{-k, q-1})\right)^T$. We need to find out which values of $k$ we are considering. Because of the anti-periodic boundary conditions, we want the following to hold:
\begin{equation}
    \chi_{u+L}^q = -\chi_{u}^q,
\end{equation}
therefore:
\begin{equation}
    \frac{1}{\sqrt{L}} \sum_{k} e^{ik(u+L)} \chi_k^q = -\frac{1}{\sqrt{L}} \sum_{k} e^{iku} \chi_k^q,
\end{equation}
meaning that $kL = (2m + 1)\pi$ where $m$ takes values from $\{0,1,2,...L-1\}$.</p>
<p>Now, if we do the Fourier transform of the Hamiltonian we obtain:</p>
\begin{equation}
    H = \sum_{k} \left[ (\chi_k^q)^\dagger H_{local} (\chi_k^q) + \left[e^{ik}(\chi_k^q)^\dagger H_{hop} (\chi_k^q) + h.c.\right] + \sum_{l=1}^{L-1}\left[e^{ikl}(\chi_k^q)^\dagger H_{l} (\chi_{k}^q) + h.c.\right]\right],
\end{equation}<p>where we have used:
\begin{equation}
\sum_{u=0}^{L-1} e^{i(k-k')u} = L\delta_{kk'}.
\end{equation}</p>
<h3 id="INFINITE-SYSTEM">INFINITE SYSTEM<a class="anchor-link" href="#INFINITE-SYSTEM"> </a></h3><p>For the infinite system, $L$ goes to infinity. Then, we need to change $d_l = l$ and $d_{l,x,y} = lq-(x-y))$ because we are not using the anti-periodic boundary conditions. 
Then, the Hamiltonian in momentum space looks as follows:</p>
\begin{equation}
    H = \sum_{k} \left[ (\chi_k^q)^\dagger H_{local} (\chi_k^q) + \left[e^{ik}(\chi_k^q)^\dagger H_{hop} (\chi_k^q) + h.c.\right] + (\chi_k^q)^\dagger H_{inf, l} (\chi_{k}^q) + h.c.\right],
\end{equation}<p>where:</p>
\begin{equation}
H_{l, inf} = 
\begin{pmatrix}
C_{0,0} &amp; C_{0,1} &amp; C_{0,2} &amp; C_{0,3} &amp; \cdots &amp; C_{0,q-2} &amp; C_{0,q-1}\\
C_{1,0} &amp; C_{1,1} &amp; C_{1,2} &amp; C_{1,3} &amp; \cdots &amp; C_{1,q-2} &amp; C_{1,q-1}\\
C_{2,0} &amp; C_{2,1} &amp; C_{2,2} &amp; C_{2,3} &amp; \cdots &amp; C_{2,q-2} &amp; C_{2,q-1}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{q-2,0} &amp; C_{q-2,1} &amp; C_{q-2,2} &amp; C_{q-2,3} &amp; \cdots &amp; C_{q-2,q-2} &amp; C_{q-2,q-1}\\
C_{q-1,0} &amp; C_{q-1,1} &amp; C_{q-1,2} &amp; C_{q-1,3} &amp; \cdots &amp; C_{q-1,q-2} &amp; C_{q-1,q-1}
\end{pmatrix},
\end{equation}\begin{equation}
C_{x,y} = f_{x,y}
\begin{pmatrix}
0 &amp; -1 \\
1  &amp; 0
\end{pmatrix}.
\end{equation}<p>where:</p>
\begin{equation}
f_{x,y} = \sum_{l=1}^{\infty} \frac{\Delta e^{ikl}}{(lq-(x-y))^\alpha} = \frac{e^{ik}}{q^{\alpha}} \sum_{l=0}^{\infty} \frac{(e^{ik})^l}{(l+\frac{q+(x-y)}{q})^{\alpha}} = \frac{e^{ik}}{q^{\alpha}} HLP(e^{ik}, \alpha, \frac{q+(x-y)}{q})).
\end{equation}<p>HLP is the Hurwitz Lerth Phi function, also called the Lerch trascendent function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.1-REAL-SPACE-HAMILTONIAN-WITH-OBC">1.1 REAL SPACE HAMILTONIAN WITH OBC<a class="anchor-link" href="#1.1-REAL-SPACE-HAMILTONIAN-WITH-OBC"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_OBC_Kitaev_LR_QP" class="doc_header"><code>H_OBC_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_OBC_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with OBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_OBC_Majoranas_Kitaev_LR_QP" class="doc_header"><code>H_OBC_Majoranas_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_OBC_Majoranas_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with OBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length. Here we use the Majorana basis.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.2-REAL-SPACE-HAMILTONIAN-WITH-APBC">1.2 REAL SPACE HAMILTONIAN WITH APBC<a class="anchor-link" href="#1.2-REAL-SPACE-HAMILTONIAN-WITH-APBC"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_APBC_Kitaev_LR_QP" class="doc_header"><code>H_APBC_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L118" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_APBC_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with APBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.3-MOMENTUM-SPACE-HAMILTONIAN-FOR-FINITE-LENGTH">1.3 MOMENTUM SPACE HAMILTONIAN FOR FINITE LENGTH<a class="anchor-link" href="#1.3-MOMENTUM-SPACE-HAMILTONIAN-FOR-FINITE-LENGTH"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_Kitaev_LR_QP" class="doc_header"><code>H_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L174" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>True</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the momentum Hamiltonian with APBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.4-MOMENTUM-SPACE-HAMILTONIAN-FOR-INFINITE-SYSTEM">1.4 MOMENTUM SPACE HAMILTONIAN FOR INFINITE SYSTEM<a class="anchor-link" href="#1.4-MOMENTUM-SPACE-HAMILTONIAN-FOR-INFINITE-SYSTEM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_Kitaev_LR_QP_inf" class="doc_header"><code>H_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L257" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Compute the momentum Hamiltonian with APBC for the Kitaev chain
with any value of alpha and Fn1/Fn. The system is infinite.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_k_H_Kitaev_LR_QP_inf" class="doc_header"><code>d_k_H_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L323" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_k_H_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Analytical derivative of the Hamiltonian for k in momentum space for an infinite system.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_phase_H_Kitaev_LR_QP_inf" class="doc_header"><code>d_phase_H_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L360" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_phase_H_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Analytical derivative of the Hamiltonian for phi in momentum space for an infinite system.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---FINITE-SYSTEM">1.5 UPPER-RIGHT BLOCK OF THE CHIRAL HAMILTONIAN - FINITE SYSTEM<a class="anchor-link" href="#1.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---FINITE-SYSTEM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="h_chiral_Kitaev_LR_QP" class="doc_header"><code>h_chiral_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L398" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>h_chiral_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Computes one block of the off-diagonal Hamiltonian in momentum space for a finite system with APBC</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---INFINITE-SYSTEM">1.5 UPPER-RIGHT BLOCK OF THE CHIRAL HAMILTONIAN - INFINITE SYSTEM<a class="anchor-link" href="#1.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---INFINITE-SYSTEM"> </a></h2><p>** I separated HLP_d and the infinite analytical expressions for the Hamiltonian in order to make the code more efficient</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="h_chiral_Kitaev_LR_QP_inf" class="doc_header"><code>h_chiral_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L446" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>h_chiral_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>AA</code></strong>, <strong><code>H_pbc_delta</code></strong>)</p>
</blockquote>
<p>Computes one block of the off-diagonal Hamiltonian in momentum space for an infinite system</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_pbc_sp" class="doc_header"><code>H_pbc_sp</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L482" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_pbc_sp</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>)</p>
</blockquote>
<p>Computes the analytical expression of the long-range infinite part of
the off-diagonal Hamiltonian. Does not depend on the chemical potential.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_h_chiral_Kitaev_LR_QP_inf" class="doc_header"><code>d_h_chiral_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L501" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_h_chiral_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>AA</code></strong>, <strong><code>d_H_pbc_delta</code></strong>)</p>
</blockquote>
<p>Computes the analytical derivative of k of one block of the off-diagonal Hamiltonian
in momentum space for an infinite system</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_H_pbc_sp" class="doc_header"><code>d_H_pbc_sp</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L519" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_H_pbc_sp</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>)</p>
</blockquote>
<p>Computes the analytical derivative of the long-range infinite part of
the off-diagonal Hamiltonian. Does not depend on the chemical potential.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HLP_d" class="doc_header"><code>HLP_d</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L538" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HLP_d</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>, <strong><code>Fn</code></strong>, <strong><code>dist</code></strong>)</p>
</blockquote>
<p>Closed form of sum of exponens using HLP function. dist is y-x</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.-LONG-RANGE-TWO-BAND-SYSTEM">2. LONG RANGE TWO-BAND SYSTEM<a class="anchor-link" href="#2.-LONG-RANGE-TWO-BAND-SYSTEM"> </a></h1><p>In order to obtain the Hamiltonian in the momentum space, we start from the follwing Hamiltonian:</p>
\begin{equation}\label{eq: hamiltonian}
    H = \sum_{n=0}^{N-1} \left [t \left (c^\dagger_{n+1}c_{n} + c^\dagger_{n}c_{n+1}\right) - \mu \left ( 2c^\dagger_{n}c_{n}-1\right) + \sum_{l=1}^{N-1}\frac{\Delta}{d^\alpha_l}\left (c^\dagger_{n+l}c^\dagger_{n} + c_{n}c_{n+l}\right)\right],
\end{equation}<p>where $t$ is the hopping amplitude, $\mu$ is the chemical potential, $\Delta$ is the superconducting pairing amplitude and $c_{n}(c^\dagger_{n})$ are the annihilation (creation) operators at the $n$th site of the chain. Consider we have a $N$ sites in the chain and our Hamiltonian is periodic with one site per unit cell.</p>
<h2 id="CALCULATIONS">CALCULATIONS<a class="anchor-link" href="#CALCULATIONS"> </a></h2><h3 id="REAL-SPACE-HAMILTONIAN">REAL SPACE HAMILTONIAN<a class="anchor-link" href="#REAL-SPACE-HAMILTONIAN"> </a></h3><p>Let's consider the following basis $\chi = \left(c_{0}, c^\dagger_{0}, c_{1}, c^\dagger_{1}, ..., c_{N-1}, c^\dagger_{N-1}\right)^T$. The Hamiltonian can be expressed as follows:</p>
\begin{equation}
    H = \chi^\dagger H_N \chi
\end{equation}<p>where:
\begin{equation}
H_N = 
\begin{pmatrix}
A_0 &amp; B &amp; C_2 &amp; C_3 &amp; \cdots &amp; C_{N-2} &amp; -B^\dagger\\
B^\dagger &amp; A_1 &amp; B &amp; C_2 &amp; \cdots &amp; C_{N-3} &amp; C_{N-2}\\
C_2^\dagger &amp; B^\dagger &amp; A_2 &amp; B &amp; \cdots &amp; C_{N-2} &amp; C_{N-3}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{N-2}^\dagger &amp; C_{N-3}^\dagger &amp; C_{N-4}^\dagger &amp; C_{N-5}^\dagger &amp; \cdots &amp; A_{N-2} &amp; B\\
-B &amp; C_{N-2}^\dagger &amp; C_{N-3}^\dagger &amp; C_{N-4}^\dagger &amp; \cdots &amp; B^\dagger &amp; A_{N-1},
\end{pmatrix}
\end{equation}</p>
<p>where</p>
\begin{equation}
A_{j} = 
\begin{pmatrix}
-\mu &amp; 0 \\
0 &amp; +\mu
\end{pmatrix},
\end{equation}\begin{equation}
B = \begin{pmatrix}
t/2 &amp; -\Delta \\
+\Delta  &amp; -t/2
\end{pmatrix},
\end{equation}\begin{equation}
C_l = \begin{pmatrix}
0 &amp; -\Delta/d_l^\alpha \\
+\Delta/d_l^\alpha  &amp; 0
\end{pmatrix}.
\end{equation}<p>and $d_l = Min(l, N-l)$. In order to obtain these results, we have considered anti-periodic boundary conditions. This means that our Hamiltonian has the following form:
\begin{equation}
H = \sum_{n=0}^{N-2} \frac{t}{2} \left (c_n^\dagger c_{n+1} - c_{n+1} c_n^\dagger + c_{n+1}^\dagger c_n - c_{n} c_{n+1}^\dagger\right) -\frac{t}{2}\left(c_{N-1}^\dagger c_0 - c_0 c_{N-1}^\dagger + c_0^\dagger c_{N-1} - c_{N-1} c_0^\dagger\right) + \sum_{n=0}^{N-1} \mu f(n)\left (c^\dagger_{n}c_{n}-c_{n}c^\dagger_{n}\right) +\sum_{n=0}^{N-1}\sum_{l=1}^{N-1-n} \frac{\Delta}{d^\alpha_l}\left (c_{n+1}^\dagger c_n^\dagger - c_n^\dagger c_{n+l}^\dagger + c_n c_{n+l} - c_{n+l} c_{n}\right).
\end{equation}</p>
<h3 id="REAL-SPACE-HAMILTONIAN---SUPERCELLS">REAL SPACE HAMILTONIAN - SUPERCELLS<a class="anchor-link" href="#REAL-SPACE-HAMILTONIAN---SUPERCELLS"> </a></h3><p>Now, let's try to express the same Hamiltonian using a different basis. Since the system has a periodicity of a site, we can split it into unit cells. Let's consider the spinor $\chi_u = \left(c_{u}, c^\dagger_{u}\right)^T$. The Hamiltonian can be expressed as follows:</p>
\begin{equation}
    H = \sum_{u=0}^{N-1} \left[ (\chi_u^q)^\dagger H_{local} (\chi_u^q) + \left[(\chi_u^q)^\dagger H_{hop} (\chi_{u+1}^q) + h.c.\right] + \sum_{l=1}^{L-1}\left[(\chi_u^q)^\dagger H_{l} (\chi_{u+l}^q) + h.c.\right]\right].
\end{equation}<p>Again, we will need to impose anti-periodic boundary conditions and we obtain:</p>
\begin{equation}
H_{local} = 
\begin{pmatrix}
-\mu  &amp; 0 \\
0 &amp; +\mu 
\end{pmatrix},
\end{equation}\begin{equation}
H_{PBC}= \begin{pmatrix}
t/2 &amp; 0 \\
0  &amp; -t/2
\end{pmatrix},
\end{equation}\begin{equation}
C_l = \begin{pmatrix}
0 &amp; -\Delta/d_l^\alpha \\
+\Delta/d_l^\alpha  &amp; 0
\end{pmatrix}.
\end{equation}<p>and $d_l = Min(l, N-l)$.</p>
<p>Here we explicitly impose that $c_{u+N} = -c_{u}$.</p>
<h3 id="FOURIER-TRANSFORM">FOURIER TRANSFORM<a class="anchor-link" href="#FOURIER-TRANSFORM"> </a></h3><p>Now, we want to write the Hamiltonian in momentum space. We transform the spinor $\chi_u$ as follows:
\begin{eqnarray}
    \chi_u = \frac{1}{\sqrt{N}} \sum_{k} e^{iku} \chi_k,\\
    (\chi_u)^\dagger = \frac{1}{\sqrt{N}} \sum_{k} e^{-iku} (\chi_k)^\dagger,
\end{eqnarray}
where $\chi_k= \left(c_{k}, c^\dagger_{-k}\right)^T$. We need to find out which values of $k$ we are considering. Because of the anti-periodic boundary conditions, we want the following to hold:
\begin{equation}
    \chi_{u+N} = -\chi_{u},
\end{equation}
therefore:
\begin{equation}
    \frac{1}{\sqrt{N}} \sum_{k} e^{ik(u+N)} \chi_k = -\frac{1}{\sqrt{N}} \sum_{k} e^{iku} \chi_k,
\end{equation}
meaning that $kN = (2m + 1)\pi$ where $m$ takes values from $\{0,1,2,...N-1\}$.</p>
<p>Now, if we do the Fourier transform of the Hamiltonian we obtain:</p>
\begin{equation}
    H = \sum_{k} \left[ (\chi_k)^\dagger H_{local} (\chi_k) + \left[e^{ik}(\chi_k)^\dagger H_{hop} (\chi_k) + h.c.\right] + \sum_{l=1}^{N-1}\left[e^{ikl}(\chi_k)^\dagger H_{l} (\chi_{k}) + h.c.\right]\right],
\end{equation}<p>where we have used:
\begin{equation}
\sum_{u=0}^{L-1} e^{i(k-k')u} = L\delta_{kk'}.
\end{equation}</p>
<p>we can simplify this in the following form:</p>
\begin{equation}
    H = \sum_{k} (\chi_k)^\dagger \left[ H_{local}  + 2H_{hop}\cos(k) + \sum_{l=1}^{N-1}\left(H_{l}\sin(kl)\right)\right]\chi_k,
\end{equation}<h3 id="INFINITE-SYSTEM">INFINITE SYSTEM<a class="anchor-link" href="#INFINITE-SYSTEM"> </a></h3><p>When $N \rightarrow \infty$, we can use the following identity:
\begin{equation}
\sum_{l=1}^{N-1}\Delta\frac{\sin(kl)}{d_l^\alpha} = -\frac{\Delta i}{2}(polylog(\alpha,e^{ik})-polylog(\alpha,e^{-ik})),
\end{equation}
assuming that in this case we don't need to apply the periodic boundary conditions, and thus $d_l = l$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.1-REAL-SPACE-OBC-HAMILTONIAN">2.1 REAL SPACE OBC HAMILTONIAN<a class="anchor-link" href="#2.1-REAL-SPACE-OBC-HAMILTONIAN"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_OBC_Kitaev_twoband" class="doc_header"><code>H_OBC_Kitaev_twoband</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L547" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_OBC_Kitaev_twoband</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with APBC for the Kitaev chain
with any value of alpha and finite length</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.2-REAL-SPACE-APBC-HAMILTONIAN">2.2 REAL SPACE APBC HAMILTONIAN<a class="anchor-link" href="#2.2-REAL-SPACE-APBC-HAMILTONIAN"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_APBC_Kitaev_twoband" class="doc_header"><code>H_APBC_Kitaev_twoband</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L589" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_APBC_Kitaev_twoband</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with APBC for the Kitaev chain
with any value of alpha and finite length</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.3-MOMENTUM-SPACE-FINITE-SYSTEM">2.3 MOMENTUM SPACE FINITE SYSTEM<a class="anchor-link" href="#2.3-MOMENTUM-SPACE-FINITE-SYSTEM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_Kitaev_twoband" class="doc_header"><code>H_Kitaev_twoband</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L637" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_Kitaev_twoband</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Compute the two band momentum Hamiltonian with APBC for the Kitaev chain
with any value of alpha and finite length</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.4-MOMENTUN-SPACE-INFINITE-SYSTEM">2.4 MOMENTUN SPACE INFINITE SYSTEM<a class="anchor-link" href="#2.4-MOMENTUN-SPACE-INFINITE-SYSTEM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_Kitaev_twoband_inf" class="doc_header"><code>H_Kitaev_twoband_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L667" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_Kitaev_twoband_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Compute the bulk Hamiltonian for the infinite Kitaev chain</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="analytic_Kitaev_twoband" class="doc_header"><code>analytic_Kitaev_twoband</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L687" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>analytic_Kitaev_twoband</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Compute the analytic form of the evals and evecs for the
bulk Hamiltonian for the two-band infinite Kitaev chain</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---FINITE-SYSTEM">2.5 UPPER-RIGHT BLOCK OF THE CHIRAL HAMILTONIAN - FINITE SYSTEM<a class="anchor-link" href="#2.5-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---FINITE-SYSTEM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="h_Kitaev_twoband" class="doc_header"><code>h_Kitaev_twoband</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L715" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>h_Kitaev_twoband</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>)</p>
</blockquote>
<p>Compute one block of the off-diagonal form of two band momentum Hamiltonian
with APBC for the Kitaev chain. Finite system.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_h_Kitaev_twoband" class="doc_header"><code>d_h_Kitaev_twoband</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L732" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_h_Kitaev_twoband</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rotation</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Compute the analytical derivative of one block of the off-diagonal form of two band
momentum Hamiltonian with APBC for the Kitaev chain. Finite system. There is a problem
with the definition of the derivative.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.6-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---INFINITE-SYSTEM">2.6 UPPER-RIGHT BLOCK OF THE CHIRAL HAMILTONIAN - INFINITE SYSTEM<a class="anchor-link" href="#2.6-UPPER-RIGHT-BLOCK-OF-THE-CHIRAL-HAMILTONIAN---INFINITE-SYSTEM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="h_Kitaev_twoband_inf" class="doc_header"><code>h_Kitaev_twoband_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L752" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>h_Kitaev_twoband_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rotation</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Compute one block of the off-diagonal form of two band momentum Hamiltonian
with APBC for the Kitaev chain. Infinite system.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_h_Kitaev_twoband_inf" class="doc_header"><code>d_h_Kitaev_twoband_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L764" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_h_Kitaev_twoband_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rotation</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Compute the analytical derivative of one block of the off-diagonal form of two band
momentum Hamiltonian with APBC for the Kitaev chain. Infinite system.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="3.-QP-SHORT-RANGE-HAMILTONIANS">3. QP SHORT RANGE HAMILTONIANS<a class="anchor-link" href="#3.-QP-SHORT-RANGE-HAMILTONIANS"> </a></h1><p>In order to obtain the Hamiltonian in the momentum space, we start from the follwing Hamiltonian:</p>
\begin{equation}\label{eq: hamiltonian}
    H = \sum_{n=1}^{N} \left [\frac{t}{2} \left (c^\dagger_{n+1}c_{n} + c^\dagger_{n}c_{n+1}\right) - \mu f(n) c^\dagger_{n}c_{n} + \frac{\Delta}{2}\left (c^\dagger_{n+1}c^\dagger_{n} + c^\dagger_{n}c^\dagger_{n+1} \right)\right] + h.c.,
\end{equation}<p>where $t$ is the hopping amplitude, $\mu$ is the chemical potential, $\Delta$ is the superconducting pairing amplitude and $c_{n}(c^\dagger_{n})$ are the annihilation (creation) operators at the $n$th site of the chain.</p>
<p>Now, we will consider $f(i) = \cos\left (2 \pi i \frac{F_{n-1}}{F_{n}}\right )$, where $F_{n-1},F_n$ are integer from the Fibonacci sequence. Therefore, our Hamiltonian has a periodicity of $F_n = q$ sites. In the thermodynamic limit, que can express it in terms of $H_local$, which defines the supercell, and $H_{PBC}$ which defines the periodic boundary conditions.</p>
<p>Let's consider the spinor $C_n^q = \left(c_{qn}, c^\dagger_{qn}, c_{qn+1}, c^\dagger_{qn+1}, ..., c_{qn+q-1}, c^\dagger_{qn+q-1}\right)^T$, which is a basis for the $n$th supercell of the system. The Hamiltonian can be expressed as follows:</p>
\begin{equation}
    H = \sum_n \left[(C_n^q)^\dagger H_{local}^q (C_n^q) + [(C_n^q)^\dagger H_{PBC}^q (C_{n+1}^q) + H.c.]\right],
\end{equation}<p>where:</p>
\begin{equation}
H_{local} = 
\begin{pmatrix}
A_0 &amp; B &amp; 0 &amp; 0 &amp;  \cdots &amp; 0 &amp; 0\\
B^\dagger &amp; A_1 &amp; B &amp; 0 &amp; \cdots &amp; 0 &amp; 0\\
0 &amp; B^\dagger &amp; A_2 &amp; B &amp; \cdots &amp; 0 &amp; 0\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; A_{q-2} &amp; B\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; B^\dagger &amp; A_{q-1},
\end{pmatrix}
\end{equation}\begin{equation}
H_{PBC} = 
\begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp;  \cdots &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0\\
B &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0,
\end{pmatrix}
\end{equation}<p>and:</p>
\begin{equation}
A_{j} = 
\begin{pmatrix}
-\mu\cos(\frac{2\pi j}{q}) &amp; 0 \\
0 &amp; +\mu\cos(\frac{2\pi j}{q}),
\end{pmatrix}
\end{equation}\begin{equation}
B = \frac{1}{2}
\begin{pmatrix}
-t &amp; -\Delta \\
+\Delta  &amp; t.
\end{pmatrix}
\end{equation}<p>Now, we want to write the Hamiltonian in momentum space. In the thermodynamic limit, we can transform the spinor $C_n^q$ as follows:
\begin{equation}
    C_n^q = \frac{1}{2\pi}\int_{[-\pi,\pi]} dk e^{ikn}C_k^q,
\end{equation}
where $C_k^q = \left(c_{k,0}, c^\dagger_{-k,0}, c_{k, 1}, c^\dagger_{-k, 1}, ..., c_{k, q-1}, c^\dagger_{-k, q-1})\right)^T$, using:</p>
\begin{equation}
\sum_{n=1}^N e^{i2\pi(k-k')n} = N\delta_{kk'}
\end{equation}<p>we obtain that:</p>
\begin{equation}
    H = \frac{1}{2\pi}\int_{[-\pi,\pi]} dk (C_k^q)^\dagger\left[H_{local} + (e^{ik}H_{PBC} + H.c) \right](C_k^q),
\end{equation}<p>therefore:</p>
\begin{equation}
H_k = H_{local} + (e^{ik}H_{PBC} + H.c) 
\end{equation}
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.1-MOMENTUM-SPACE-HAMILTONIAN-FOR-INFINITE-SYSTEM">3.1 MOMENTUM SPACE HAMILTONIAN FOR INFINITE SYSTEM<a class="anchor-link" href="#3.1-MOMENTUM-SPACE-HAMILTONIAN-FOR-INFINITE-SYSTEM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_OBC_Kitaev_SR_QP" class="doc_header"><code>H_OBC_Kitaev_SR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L777" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_OBC_Kitaev_SR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space OBC Hamiltonian for the Kitaev chain
with any value of alpha and Fn1/Fn and short range</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_OBC_Majoranas_Kitaev_SR_QP" class="doc_header"><code>H_OBC_Majoranas_Kitaev_SR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L825" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_OBC_Majoranas_Kitaev_SR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with OBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length. Here we use the Majorana basis.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_Kitaev_SR_QP" class="doc_header"><code>H_Kitaev_SR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L868" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_Kitaev_SR_QP</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the bulk Hamiltonian (Nambu spinor basis) for the Kitaev chain
with any value of alpha and Fn1/Fn</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="OTHER-FUNCTIONS">OTHER FUNCTIONS<a class="anchor-link" href="#OTHER-FUNCTIONS"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Fibonacci" class="doc_header"><code>Fibonacci</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L924" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Fibonacci</code>(<strong><code>iterations</code></strong>)</p>
</blockquote>
<p>Return Fibonacci sequence number depending on the iterations</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rot_sigma_y" class="doc_header"><code>rot_sigma_y</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L938" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rot_sigma_y</code>(<strong><code>pvec</code></strong>, <strong><code>psi</code></strong>, <strong><code>Fn</code></strong>)</p>
</blockquote>
<p>Rotation around sigma y of an angle psi</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="f" class="doc_header"><code>f</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L949" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>f</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>)</p>
</blockquote>
<p>Function f(k,alpha) in terms of the polylog functions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df" class="doc_header"><code>df</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L957" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>)</p>
</blockquote>
<p>Derivative of function f(k,alpha) in terms of the polylog functions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HLP" class="doc_header"><code>HLP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L965" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HLP</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>, <strong><code>Fn</code></strong>, <strong><code>x</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>
<p>Closed form of sum of exponens using HLP function</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sparse_diag" class="doc_header"><code>sparse_diag</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L974" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sparse_diag</code>(<strong><code>matrix</code></strong>, <strong><code>k</code></strong>, <strong><code>sigma</code></strong>=<em><code>0</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Call sla.eigsh with mumps support.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

