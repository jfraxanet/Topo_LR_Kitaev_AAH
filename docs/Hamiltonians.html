---

title: 1. HAMILTONIANS

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_Hamiltonians.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We start from the follwing expression of the Hamiltonian:</p>
$$
    H = \sum_{n=0}^{N-1} \left [t \left (c^\dagger_{i+1}c_{i} + c^\dagger_{i}c_{i+1}\right) - \mu f(i)\left ( 2c^\dagger_{i}c_{i}-1\right) + \sum_{l=1}^{N-1}\frac{\Delta}{d^\alpha_l}\left (c^\dagger_{i+l}c^\dagger_{i} + c_{i}c_{i+l}\right)\right],
$$<p>where $t$ is the hopping amplitude, $\mu$ is the chemical potential, $\Delta$ is the superconducting pairing amplitude and $c_{i}(c^\dagger_{i})$ are the annihilation (creation) operators at the $i$-th site of the chain. The superconducting pairing is taken to decay as a power law $l^{-\alpha}$, where $l$ denotes the distance between the sites and the scaling exponent $\alpha \in \mathbb{R}$. For a constant chemical potential $f(i)=1$, we recover the long-range Kitaev chain with homogeneous onsite potential. The AAH chemical potential corresponds to $f(i) = \cos\left (2 \pi n \frac{F_{n-1}}{F_{n}} + \phi \right )$, where $F_{n-1},F_n$ are integers from the Fibonacci sequence and $\phi$ is the phase. Therefore, our Hamiltonian has a periodicity of $F_n = q$ sites.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.1-Real-space-Hamiltonian-with-open-boundary-conditions-(OBC)">1.1 Real space Hamiltonian with open boundary conditions (OBC)<a class="anchor-link" href="#1.1-Real-space-Hamiltonian-with-open-boundary-conditions-(OBC)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's consider the following basis $\chi = \left(c_{0}, c^\dagger_{0}, c_{1}, c^\dagger_{1}, ..., c_{N-1}, c^\dagger_{N-1}\right)^T$. The Hamiltonian can be expressed as follows:</p>
$$
    H = \chi^\dagger H_N \chi
$$<p>where:
$$
H_N = 
\begin{pmatrix}
A_0 &amp; B &amp; C_2 &amp; C_3 &amp; \cdots &amp; C_{N-2} &amp; C_{N-1}\\
B^\dagger &amp; A_1 &amp; B &amp; C_2 &amp; \cdots &amp; C_{N-3} &amp; C_{N-2}\\
C_2^\dagger &amp; B^\dagger &amp; A_2 &amp; B &amp; \cdots &amp; C_{N-2} &amp; C_{N-3}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{N-2}^\dagger &amp; C_{N-3}^\dagger &amp; C_{N-4}^\dagger &amp; C_{N-5}^\dagger &amp; \cdots &amp; A_{N-2} &amp; B\\
C_{N-1}^\dagger &amp; C_{N-2}^\dagger &amp; C_{N-3}^\dagger &amp; C_{N-4}^\dagger &amp; \cdots &amp; B^\dagger &amp; A_{N-1},
\end{pmatrix}
$$</p>
<p>where</p>
$$
A_{j} = 
\begin{pmatrix}
-\mu f(j) &amp; 0 \\
0 &amp; +\mu f(j)
\end{pmatrix},
$$$$
B = \begin{pmatrix}
t/2 &amp; -\Delta \\
+\Delta  &amp; -t/2
\end{pmatrix},
$$$$
C_l = \begin{pmatrix}
0 &amp; -\Delta/l^\alpha \\
+\Delta/l^\alpha  &amp; 0
\end{pmatrix}.
$$<p>We compute the Hamiltonian with OBC both in de BdG and the Majorana basis.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_OBC_Kitaev_LR_QP" class="doc_header"><code>H_OBC_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_OBC_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with OBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length L.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_OBC_Majoranas_Kitaev_LR_QP" class="doc_header"><code>H_OBC_Majoranas_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_OBC_Majoranas_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with OBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length L. Here we use the Majorana basis.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.2-Real-space-Hamiltonian-with-anti-periodic-boundary-conditions-(APBC)">1.2 Real space Hamiltonian with anti-periodic boundary conditions (APBC)<a class="anchor-link" href="#1.2-Real-space-Hamiltonian-with-anti-periodic-boundary-conditions-(APBC)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Hamiltonian with anti-periodic boundary conditions takes the following form:
$$
H = \sum_{i=0}^{N-2} \frac{t}{2} \left (c_i^\dagger c_{i+1} - c_{i+1} c_i^\dagger + c_{i+1}^\dagger c_i - c_{i} c_{i+1}^\dagger\right) -\frac{t}{2}\left(c_{N-1}^\dagger c_0 - c_0 c_{N-1}^\dagger + c_0^\dagger c_{N-1} - c_{N-1} c_0^\dagger\right)\\ + \sum_{i=0}^{N-1} \mu f(i)\left (c^\dagger_{i}c_{i}-c_{i}c^\dagger_{i}\right) +\sum_{i=0}^{N-1}\sum_{l=1}^{N-1-i} \frac{\Delta}{d^\alpha_l}\left (c_{i+1}^\dagger c_i^\dagger - c_i^\dagger c_{i+l}^\dagger + c_i c_{i+l} - c_{i+l} c_{i}\right).
$$</p>
<p>where $d_l = \text{min}(l, N-l)$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the system has a periodicity of $q$ sites, we can split it into supercells. Let's consider that we have $L = N/q$ of such supercells, and let's consider the spinor $\chi_u = \left(c_{qu}, c^\dagger_{qu}, c_{qu+1}, c^\dagger_{qu+1}, ..., c_{qu+(q-1)}, c^\dagger_{qu+(q-1)}\right)^T$. The Hamiltonian can be expressed as follows:</p>
$$
    H = \sum_{u=0}^{L-1} \left[ \chi_u^\dagger H_{\text{local}} \chi_u + ( \chi_u^\dagger H_{\text{hop}} \chi_{u+1} + {\rm h.c.})
    + \sum_{l=1}^{L-1}( \chi_u^\dagger H_{\text{l}} \chi_{u+l} + {\rm h.c.}) \right],
$$<p>where,</p>
$$
H_{\text{local}} = 
\begin{pmatrix}
A_0 &amp; B &amp; C_2 &amp; \cdots &amp; C_{q-1}\\
B^\dagger &amp; A_1 &amp; B &amp; \cdots  &amp; C_{q-2}\\
C_2^\dagger &amp; B^\dagger &amp; A_2  &amp; \cdots  &amp; C_{q-3}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{q-2}^\dagger &amp; C_{q-3}^\dagger &amp; C_{q-4}^\dagger  &amp; \cdots  &amp; B\\
C_{q-1}^\dagger &amp; C_{q-2}^\dagger &amp; C_{q-3}^\dagger &amp; \cdots &amp; A_{q-1}
\end{pmatrix},
$$$$
H_{\text{hop}} = 
\begin{pmatrix}
0 &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; 0 &amp;  \cdots  &amp; 0\\
\vdots   &amp; \vdots &amp; \ddots &amp; \vdots\\
B' &amp; 0 &amp;  \cdots  &amp; 0
\end{pmatrix},
$$<p>and,</p>
$$
H_{\text{l}} = 
\begin{pmatrix}
C_{l,0,0} &amp; C_{l,0,1} &amp; \cdots &amp; C_{l,0,q-1}\\
C_{l,1,0} &amp; C_{l,1,1} &amp; \cdots &amp; C_{l,1,q-1}\\
C_{l,2,0} &amp; C_{l,2,1} &amp; \cdots  &amp; C_{l,2,q-1}\\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{l,q-2,0} &amp; C_{l,q-2,1} &amp; \cdots &amp;  C_{l,q-2,q-1}\\
C_{l,q-1,0} &amp; C_{l,q-1,1} &amp; \cdots &amp; C_{l,q-1,q-1}
\end{pmatrix},
$$<p>where $B' = \frac{t}{2}\sigma_z$ and $C_{l,x,y} = -\frac{\Delta}{2d_{l,x,y}^{\alpha}} i\sigma_y$. Now,</p>
$$
d_{l,x,y} = \text{min}\left(lq-(x-y), N-(lq-(x-y))\right).
$$<p>Note that in order to impose anti-periodic boundary conditions, we have used that $c_{uq+x+q} = -c_{uq+x}$ in $H_{\text{local}}$ and $c_{(u+L)q + x} = -c_{uq+x}$ in $H_{\text{hop}}$ and $H_{\text{l}}$.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_APBC_Kitaev_LR_QP" class="doc_header"><code>H_APBC_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L115" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_APBC_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the real space Hamiltonian with APBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length L.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.3-Momentum-space-Hamiltonian-for-a-finite-system.">1.3 Momentum space Hamiltonian for a finite system.<a class="anchor-link" href="#1.3-Momentum-space-Hamiltonian-for-a-finite-system."> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we want to write the Hamiltonian in momentum space. We transform the spinor $\chi_u$ as follows:</p>
$$
    \chi_u = \frac{1}{\sqrt{L}} \sum_{k} e^{iku} \chi_k, \quad
    \chi_u^\dagger = \frac{1}{\sqrt{L}} \sum_{k} e^{-iku} \chi_k^\dagger,
$$<p>where $\chi_k= \left(c_{k,0}, c^\dagger_{-k,0}, c_{k, 1}, c^\dagger_{-k, 1}, ..., c_{k, q-1}, c^\dagger_{-k, q-1})\right)^T$. 
For finite systems, there is a discrete set of momentums $k$ allowed in the system. Because of the anti-periodic boundary conditions, we want the following to hold:
$$
    \chi_{u+L} = -\chi_{u},
$$
therefore:
$$
    \frac{1}{\sqrt{L}} \sum_{k} e^{ik(u+L)} \chi_k = -\frac{1}{\sqrt{L}} \sum_{k} e^{iku} \chi_k,
$$
meaning that $kL = (2m + 1)\pi$ where $m$ takes values from $\{0,1,2,...L-1\}$.</p>
<p>Now, if we do the Fourier transform of the Hamiltonian we obtain:</p>
$$
    H = \sum_{k} \left[ \chi_k^\dagger H_\text{local} \chi_k + \left(e^{ik} \chi_k^\dagger H_\text{hop} \chi_k + {\rm h.c.}\right) + \sum_{l=1}^{L-1}\left(e^{ikl}\chi_k^\dagger H_{l} \chi_{k} + {\rm h.c.}\right)\right],
$$<p>where we have used:
$$
\sum_{u=0}^{L-1} e^{i(k-k')u} = L\delta_{kk'}.
$$</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_Kitaev_LR_QP" class="doc_header"><code>H_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>rot</code></strong>=<em><code>True</code></em>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the momentum Hamiltonian with APBC for the Kitaev chain
with any value of alpha, Fn1/Fn and finite length L.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.31-Block-off-diagonal-Hamiltonian-for-the-finite-system">1.31 Block-off diagonal Hamiltonian for the finite system<a class="anchor-link" href="#1.31-Block-off-diagonal-Hamiltonian-for-the-finite-system"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="h_chiral_Kitaev_LR_QP" class="doc_header"><code>h_chiral_Kitaev_LR_QP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L254" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>h_chiral_Kitaev_LR_QP</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>length</code></strong>, <strong><code>AA</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Computes one block of the off-diagonal Hamiltonian in momentum space for a finite system with APBC.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the infinite system, $L$ goes to infinity. Then, we need to change $d_l = l$ and $d_{l,x,y} = lq-(x-y))$ because the anti-periodic boundary conditions do not need to be explicitly imposed anymore.
The Hamiltonian in momentum space looks as follows:</p>
$$
    H = \sum_{k} \left[\chi_k^\dagger H_\text{local} \chi_k + \left(e^{ik}\chi_k^\dagger H_\text{hop} \chi_k + \text{h.c.}\right)  + \left(\chi_k^\dagger H_\text{inf} \chi_{k} + \text{h.c.}\right)\right]
$$<p>where:</p>
$$
H_{l, inf} = 
\begin{pmatrix}
C_{0,0} &amp; C_{0,1} &amp; C_{0,2} &amp; C_{0,3} &amp; \cdots &amp; C_{0,q-2} &amp; C_{0,q-1}\\
C_{1,0} &amp; C_{1,1} &amp; C_{1,2} &amp; C_{1,3} &amp; \cdots &amp; C_{1,q-2} &amp; C_{1,q-1}\\
C_{2,0} &amp; C_{2,1} &amp; C_{2,2} &amp; C_{2,3} &amp; \cdots &amp; C_{2,q-2} &amp; C_{2,q-1}\\
\vdots  &amp; \vdots  &amp; \vdots  &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
C_{q-2,0} &amp; C_{q-2,1} &amp; C_{q-2,2} &amp; C_{q-2,3} &amp; \cdots &amp; C_{q-2,q-2} &amp; C_{q-2,q-1}\\
C_{q-1,0} &amp; C_{q-1,1} &amp; C_{q-1,2} &amp; C_{q-1,3} &amp; \cdots &amp; C_{q-1,q-2} &amp; C_{q-1,q-1}
\end{pmatrix},
$$<p>where $C_{x,y} = ig_{xy}\sigma_y$. The function $g_{xy}$ is defined as follows</p>
$$
g_{xy} = -\sum_{l=1}^{\infty} \frac{\Delta e^{ikl}}{[q-(x-y)]^\alpha}  = \frac{e^{ik}}{q^{\alpha}} \text{HLP}_{\alpha} \left(k, q, x-y\right),
$$<p>where HLP is the Hurwitz Lerth Phi function, also called the Lerch trascendent function.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_Kitaev_LR_QP_inf" class="doc_header"><code>H_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L302" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Compute the momentum Hamiltonian with APBC for the Kitaev chain
with any value of alpha and Fn1/Fn. The system is infinite.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.41-Block-off-diagonal-Hamiltonian-for-the-infinite-system">1.41 Block-off diagonal Hamiltonian for the infinite system<a class="anchor-link" href="#1.41-Block-off-diagonal-Hamiltonian-for-the-infinite-system"> </a></h3><p>HLP_d and the infinite analytical expressions for the Hamiltonian are separated in order to make the code more efficient</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="h_chiral_Kitaev_LR_QP_inf" class="doc_header"><code>h_chiral_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L369" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>h_chiral_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>AA</code></strong>, <strong><code>H_pbc_delta</code></strong>)</p>
</blockquote>
<p>Computes one block of the off-diagonal Hamiltonian in momentum space for an infinite system</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="H_pbc_sp" class="doc_header"><code>H_pbc_sp</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L405" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>H_pbc_sp</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>)</p>
</blockquote>
<p>Computes the analytical expression of the long-range infinite part of
the off-diagonal Hamiltonian. Does not depend on the chemical potential.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_h_chiral_Kitaev_LR_QP_inf" class="doc_header"><code>d_h_chiral_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L424" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_h_chiral_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>AA</code></strong>, <strong><code>d_H_pbc_delta</code></strong>)</p>
</blockquote>
<p>Computes the analytical derivative of k of one block of the off-diagonal Hamiltonian
in momentum space for an infinite system</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_H_pbc_sp" class="doc_header"><code>d_H_pbc_sp</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L442" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_H_pbc_sp</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>)</p>
</blockquote>
<p>Computes the analytical derivative of the long-range infinite part of
the off-diagonal Hamiltonian. Does not depend on the chemical potential.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HLP_d" class="doc_header"><code>HLP_d</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L461" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HLP_d</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>, <strong><code>Fn</code></strong>, <strong><code>dist</code></strong>)</p>
</blockquote>
<p>Closed form of sum of exponents using HLP function. dist is y-x</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.42-Analytical-derivatives-of-the-infinite-system-Hamiltonian">1.42 Analytical derivatives of the infinite system Hamiltonian<a class="anchor-link" href="#1.42-Analytical-derivatives-of-the-infinite-system-Hamiltonian"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_k_H_Kitaev_LR_QP_inf" class="doc_header"><code>d_k_H_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L470" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_k_H_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Analytical derivative of the infinite system Hamiltonian in terms of the momentum k.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="d_phase_H_Kitaev_LR_QP_inf" class="doc_header"><code>d_phase_H_Kitaev_LR_QP_inf</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L507" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>d_phase_H_Kitaev_LR_QP_inf</code>(<strong><code>params</code></strong>, <strong><code>k</code></strong>, <strong><code>mu</code></strong>, <strong><code>rot</code></strong>=<em><code>False</code></em>, <strong><code>AA</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Analytical derivative of the infinite system Hamiltonian in terms of the phase phi.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.-OTHER-FUNCTIONS">2. OTHER FUNCTIONS<a class="anchor-link" href="#2.-OTHER-FUNCTIONS"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Fibonacci" class="doc_header"><code>Fibonacci</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L545" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Fibonacci</code>(<strong><code>iterations</code></strong>)</p>
</blockquote>
<p>Return Fibonacci sequence number depending on the iterations</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rot_sigma_y" class="doc_header"><code>rot_sigma_y</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L559" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rot_sigma_y</code>(<strong><code>pvec</code></strong>, <strong><code>psi</code></strong>, <strong><code>Fn</code></strong>)</p>
</blockquote>
<p>Rotation around sigma y of an angle psi</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="f" class="doc_header"><code>f</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L570" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>f</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>)</p>
</blockquote>
<p>Function f(k,alpha) in terms of the polylog functions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df" class="doc_header"><code>df</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L578" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>)</p>
</blockquote>
<p>Derivative of function f(k,alpha) in terms of the polylog functions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HLP" class="doc_header"><code>HLP</code><a href="https://github.com/jfraxanet/Topo_LR_Kitaev_AAH/tree/master/Topo_LR_Kitaev_AAH/Hamiltonians.py#L586" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HLP</code>(<strong><code>k</code></strong>, <strong><code>alpha</code></strong>, <strong><code>Fn</code></strong>, <strong><code>x</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>
<p>Closed form of sum of exponens using HLP function</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

